<view class="invoice-detail-container"><view class="header"><view class="header-bg"></view><view class="header-content"><view class="title-area"><text class="title">发票详情</text><text class="subtitle">{{"订单号: "+(orderInfo.orderNo||'-')}}</text></view></view></view><block wx:if="{{loading}}"><view class="loading-state"><view class="loading-spinner"><view class="dot"></view><view class="dot"></view><view class="dot"></view></view><text class="loading-text">正在加载...</text></view></block><block wx:else><block wx:if="{{invoiceRequest}}"><view class="invoice-info"><view class="status-card"><view class="{{['status-icon',statusClass]}}"><text class="icon">{{statusIcon}}</text></view><view class="status-text"><text class="status-title">{{statusTitle}}</text><text class="status-desc">{{statusDesc}}</text></view></view><view class="info-section"><view class="section-title">申请信息</view><view class="info-row"><text class="label">申请时间</text><text class="value">{{$root.m0}}</text></view><block wx:if="{{invoiceTitle}}"><view class="info-row"><text class="label">发票抬头</text><text class="value">{{invoiceTitle.companiesName}}</text></view></block><block wx:if="{{invoiceTitle&&invoiceTitle.taxNumber}}"><view class="info-row"><text class="label">税号</text><text class="value">{{invoiceTitle.taxNumber}}</text></view></block></view><block wx:if="{{invoiceRequest.status===1}}"><view class="action-section"><block wx:if="{{invoiceRequest.invoicePhoto}}"><view class="invoice-preview"><view class="preview-header"><text class="preview-title">电子发票</text><view class="preview-actions"><view data-event-opts="{{[['tap',[['handleViewDocument',[photoBaseUrl+invoiceRequest.invoicePhoto]]]]]}}" class="action-tag" bindtap="__e"><uni-icons vue-id="6c50c1e4-1" type="eye-filled" size="14" color="#2979FF" bind:__l="__l"></uni-icons><text>预览</text></view><view data-event-opts="{{[['tap',[['handleSaveDocument',[photoBaseUrl+invoiceRequest.invoicePhoto]]]]]}}" class="action-tag" bindtap="__e"><uni-icons vue-id="6c50c1e4-2" type="download-filled" size="14" color="#2979FF" bind:__l="__l"></uni-icons><text>保存</text></view></view></view><block wx:if="{{$root.m1}}"><view class="image-container"><image class="invoice-image" src="{{photoBaseUrl+invoiceRequest.invoicePhoto}}" mode="widthFix" data-event-opts="{{[['tap',[['previewInvoiceImage',[photoBaseUrl+invoiceRequest.invoicePhoto]]]]]}}" bindtap="__e"></image><view class="image-mask"><text>点击查看大图</text></view></view></block><block wx:else><block wx:if="{{$root.m2}}"><view class="pdf-container"><view data-event-opts="{{[['tap',[['openPdfDocument',[photoBaseUrl+invoiceRequest.invoicePhoto]]]]]}}" class="pdf-placeholder" bindtap="__e"><view class="pdf-icon"><uni-icons vue-id="6c50c1e4-3" type="file-filled" size="46" color="#F56C6C" bind:__l="__l"></uni-icons><text class="pdf-text">PDF</text></view><text class="pdf-name">电子发票文件.pdf</text><view class="pdf-tip"><uni-icons vue-id="6c50c1e4-4" type="hand-up" size="14" color="#999999" bind:__l="__l"></uni-icons><text>点击查看PDF文件</text></view></view></view></block><block wx:else><view class="file-container"><view data-event-opts="{{[['tap',[['openDocument',[photoBaseUrl+invoiceRequest.invoicePhoto]]]]]}}" class="file-placeholder" bindtap="__e"><view class="file-icon"><uni-icons vue-id="6c50c1e4-5" type="file-filled" size="46" color="#909399" bind:__l="__l"></uni-icons></view><text class="file-name">电子发票文件</text><view class="file-tip"><uni-icons vue-id="6c50c1e4-6" type="hand-up" size="14" color="#999999" bind:__l="__l"></uni-icons><text>点击查看文件</text></view></view></view></block></block></view></block></view></block><block wx:if="{{invoiceRequest.status===2}}"><view class="reject-section"><view class="reject-title">驳回原因</view><view class="reject-reason">{{invoiceRequest.overrule||'未提供驳回原因'}}</view><view data-event-opts="{{[['tap',[['goToApply',['$event']]]]]}}" class="reapply-btn" bindtap="__e"><text>重新申请</text></view></view></block></view></block><block wx:else><view class="empty-state"><image class="empty-image" src="/static/img/invoice-empty.png"></image><text class="empty-title">暂无发票申请</text><text class="empty-desc">您还没有为此订单申请开具电子发票</text><view data-event-opts="{{[['tap',[['goToApply',['$event']]]]]}}" class="apply-btn" bindtap="__e"><text>前去开票</text></view></view></block></block><block wx:if="{{orderInfo.orderId}}"><view class="order-section"><view class="section-title">订单信息</view><view class="info-row"><text class="label">订单号</text><text class="value">{{orderInfo.orderNo||'-'}}</text></view><view class="info-row"><text class="label">订单金额</text><text class="value price">{{"¥"+(orderInfo.orderTotalPrice||'0.00')}}</text></view><view class="info-row"><text class="label">收件人</text><text class="value">{{orderInfo.receiverName||'-'}}</text></view><view class="info-row"><text class="label">联系电话</text><text class="value">{{orderInfo.receiverPhone||'-'}}</text></view><view class="info-row"><text class="label">收货地址</text><text class="value address">{{$root.m3}}</text></view><view class="info-row"><text class="label">下单时间</text><text class="value">{{$root.m4}}</text></view><view class="info-row"><text class="label">完成时间</text><text class="value">{{$root.m5}}</text></view></view></block></view>