<view class="send-container"><view class="tab-header"><block wx:for="{{tabs}}" wx:for-item="tab" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['navToTab',[index]]]]]}}" class="{{['tab-item',[(currentTab===index)?'active':'']]}}" bindtap="__e"><image class="tab-icon" src="{{tab.icon}}" mode="aspectFit"></image><text>{{tab.name}}</text></view></block></view><view class="main-content"><scroll-view class="content-scroll" style="{{'height:'+('calc(100vh - '+(isIPhoneX?'168rpx':'118rpx')+')')+';'}}" scroll-y="{{true}}" scroll-top="{{scrollTop}}"><view class="content-area"><view class="form-card"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-1" type="paperplane" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">批量寄件</text></view><view data-event-opts="{{[['tap',[['addNewOrder',['$event']]]]]}}" class="add-btn ripple" bindtap="__e"><uni-icons vue-id="48f739aa-2" type="plusempty" size="18" color="#FFFFFF" bind:__l="__l"></uni-icons><text>新增订单</text></view></view><view class="form-content"><view class="batch-desc"><text>您可以添加多个快递订单，统一安排取件和支付</text></view></view></view><block wx:if="{{$root.g0===0}}"><view class="empty-state"><image class="empty-icon" src="/static/img/empty-box.png" mode="aspectFit"></image><text class="empty-text">暂无批量寄件订单</text><view data-event-opts="{{[['tap',[['addNewOrder',['$event']]]]]}}" class="empty-btn" bindtap="__e"><text>添加寄件订单</text></view></view></block><block wx:else><view class="batch-order-list"><block wx:for="{{$root.l0}}" wx:for-item="order" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['editOrder',[index]]]]]}}" class="batch-order-item" bindtap="__e"><view class="order-content"><view class="card-actions"><view data-event-opts="{{[['tap',[['editOrder',[index]]]]]}}" class="action-icon edit" catchtap="__e"><uni-icons vue-id="{{'48f739aa-3-'+index}}" type="compose" size="18" color="#3A86FF" bind:__l="__l"></uni-icons></view><view data-event-opts="{{[['tap',[['deleteOrder',[index]]]]]}}" class="action-icon delete" catchtap="__e"><uni-icons vue-id="{{'48f739aa-4-'+index}}" type="trash" size="18" color="#FF5252" bind:__l="__l"></uni-icons></view></view><view class="order-addresses vertical"><view class="order-address sender-section"><text class="address-tag sender">寄</text><view class="address-info"><view class="person-info"><text class="name">{{order.$orig.senderName}}</text><text class="phone">{{order.m0}}</text></view><text class="address">{{order.$orig.senderProvince+order.$orig.senderCity+order.$orig.senderDistrict+order.$orig.senderDetailAddress}}</text></view></view><view class="address-divider"><view class="divider-line"></view><view class="divider-arrow"><uni-icons vue-id="{{'48f739aa-5-'+index}}" type="arrowdown" size="16" color="#CCCCCC" bind:__l="__l"></uni-icons></view><view class="divider-line"></view></view><view class="order-address receiver-section"><text class="address-tag receiver">收</text><view class="address-info"><view class="person-info"><text class="name">{{order.$orig.receiverName}}</text><text class="phone">{{order.m1}}</text></view><text class="address">{{order.$orig.receiverProvince+order.$orig.receiverCity+order.$orig.receiverDistrict+order.$orig.receiverDetailAddress}}</text></view></view></view><view class="order-details"><view class="order-item-info"><text class="item-type">{{order.$orig.itemTypeName||'普通物品'}}</text><text class="item-weight">{{order.$orig.estimatedItemWeight+"kg"}}</text></view><view class="order-price"><text>{{"¥"+order.g1}}</text></view></view><view class="insurance-section"><view class="insurance-header"><view class="insurance-toggle"><view class="label-container"><uni-icons vue-id="{{'48f739aa-6-'+index}}" type="shield" size="16" color="#FF6B01" bind:__l="__l"></uni-icons><text class="label">物品保价</text></view><block wx:if="{{order.m2}}"><view data-event-opts="{{[['tap',[['toggleOrderInsurance',[index]]]]]}}" class="{{['toggle-switch',(order.$orig.insured)?'active':'']}}" catchtap="__e"><view class="switch-handle"></view></view></block><block wx:else><view class="not-supported-tip"><text>不支持</text><uni-icons vue-id="{{'48f739aa-7-'+index}}" type="info" size="14" color="#FFFFFF" data-event-opts="{{[['^click',[['showInsuranceNotSupportedTip',[index]]]]]}}" catch:click="__e" bind:__l="__l"></uni-icons></view></block></view><text class="insurance-hint">贵重物品建议保价，可获得更高赔付</text></view><block wx:if="{{order.m3}}"><view class="insurance-input-row"><text class="input-label">保价金额</text><view class="value-input-wrapper"><text class="currency-symbol">¥</text><input class="value-input" type="digit" placeholder="请输入保价金额" data-event-opts="{{[['input',[['e0',['$event']]]],['tap',[['',['$event']]]]]}}" data-event-params="{{({index})}}" value="{{order.$orig.insuranceValue||''}}" bindinput="__e" catchtap="__e"/></view></view></block><block wx:if="{{order.m4}}"><view class="insurance-fee-row"><text class="fee-label">保价费用</text><text class="fee-value">{{"¥"+order.m5}}</text></view></block></view><block wx:if="{{order.m6}}"><view class="insurance-rule-row"><view class="rule-label">保价规则</view><view class="rule-content">{{''+order.m7+''}}</view></view></block></view></view></block></view></block><block wx:if="{{$root.g2!==0}}"><view class="form-card express-card-section" style="animation-delay:0.3s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-8" type="car" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">快递选项</text></view></view><view class="form-content"><view class="express-options-section"><text class="section-title">快递公司</text><block wx:if="{{expressLoading}}"><view class="express-loading-state"><text>正在获取快递报价...</text><view class="loading-spinner"></view></view></block><block wx:else><block wx:if="{{$root.g3===0}}"><view class="express-empty-hint"><text>请完善寄收件信息获取快递报价</text></view></block><block wx:else><view class="express-list"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="index" wx:key="id"><view data-event-opts="{{[['tap',[['selectExpress',[index]]]]]}}" class="{{['express-item-vertical',(formData.expressIndex===index)?'active':'']}}" bindtap="__e"><view class="express-item-left"><image class="express-logo" src="{{item.m8}}" mode="aspectFit"></image><text class="express-name">{{item.$orig.name}}</text></view><view class="express-item-right"><text class="express-price">{{"¥"+item.g4}}</text></view></view></block></view></block></block></view></view></view></block><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.4s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-9" type="calendar" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">取件时间</text></view></view><view class="form-content"><view class="pickup-time-header"><text class="pickup-tip">快递小哥会在您选择的时间上门取件</text></view><view class="date-selector"><scroll-view class="date-scroll" scroll-x="{{true}}" show-scrollbar="false"><view class="date-scroll-container"><block wx:for="{{pickupDateOptions}}" wx:for-item="date" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectPickupDate',['$0'],[[['pickupDateOptions','',index,'value']]]]]]]}}" class="{{['date-item',(formData.pickupDate===date.value)?'active':'']}}" bindtap="__e"><text class="date-text">{{date.label}}</text></view></block></view></scroll-view></view><view class="time-selector"><view class="time-options"><block wx:for="{{$root.l2}}" wx:for-item="time" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" data-event-params="{{({time})}}" class="{{['time-item',(formData.pickupTime===time.value)?'active':'']}}" bindtap="__e"><text class="time-text">{{time.label}}</text></view></block></view></view></view></view></block><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.7s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-10" type="wallet" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">支付方式</text></view></view><view class="form-content"><view class="payment-methods"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='online')?'active':'',(!$root.m9)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon wechat"><uni-icons vue-id="48f739aa-11" type="weixin" size="20" color="#09BB07" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">微信支付</text><block wx:if="{{$root.m10}}"><text class="payment-desc">支持微信快捷支付</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='online')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='online'}}"><view class="radio-inner"></view></block></view></view></view><block wx:if="{{hasMonthlyAccount}}"><view data-event-opts="{{[['tap',[['e3',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='monthly')?'active':'',(!$root.m11)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon monthly"><uni-icons vue-id="48f739aa-12" type="calendar" size="20" color="#FF6B01" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">月结账户</text><block wx:if="{{$root.m12}}"><text class="payment-desc">使用企业月结账户支付</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='monthly')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='monthly'}}"><view class="radio-inner"></view></block></view></view></view></block><view data-event-opts="{{[['tap',[['e4',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='onlineCollect')?'active':'',(!$root.m13)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon cod"><uni-icons vue-id="48f739aa-13" type="shop" size="20" color="#3A86FF" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">线上到付</text><block wx:if="{{$root.m14}}"><text class="payment-desc">快递收货后付款</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持到付</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='onlineCollect')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='onlineCollect'}}"><view class="radio-inner"></view></block></view></view></view></view></view></view></block><block wx:if="{{hasExpressOptions&&availableBalance>0}}"><view class="form-card" style="animation-delay:0.6s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-14" type="wallet" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">佣金抵扣</text></view></view><view class="form-content"><view class="{{['balance-card',(!canUseCommission)?'disabled':'']}}"><view class="balance-header"><view class="balance-info"><view class="service-icon"><view class="{{['checkbox-wrapper',(formData.useCommission)?'active':'',(!canUseCommission)?'disabled':'']}}"><uni-icons vue-id="48f739aa-15" type="checkmarkempty" size="16" color="#FFFFFF" vif="formData.useCommission" bind:__l="__l"></uni-icons></view></view><view class="service-details"><view><text class="service-title">佣金抵扣</text></view><view><text class="service-desc">{{"可用余额 ¥"+$root.g5}}</text></view></view></view><view class="service-toggle"><switch checked="{{formData.useCommission}}" color="#FF6B01" disabled="{{!canUseCommission}}" data-event-opts="{{[['change',[['toggleUseBalance',['$event']]]]]}}" bindchange="__e"></switch></view></view><block wx:if="{{!canUseCommission}}"><view class="payment-notice"><uni-icons vue-id="48f739aa-16" type="info" size="14" color="#999" bind:__l="__l"></uni-icons><text>当前快递公司或支付方式不支持使用佣金抵扣</text></view></block><block wx:if="{{formData.useCommission}}"><view class="balance-detail"><view class="balance-explainer"><uni-icons vue-id="48f739aa-17" type="info-filled" size="18" color="#FF6B01" bind:__l="__l"></uni-icons><text>{{"已抵扣 ¥"+formData.commissionAmount}}</text></view><view class="deduction-info"><text class="deduction-label">抵扣后需支付：</text><text class="deduction-amount">{{"¥"+($root.m15-$root.m16>0?$root.g6:'0.00')}}</text></view></view></block></view></view></view></block><block wx:if="{{$root.g7>0}}"><view class="form-card" style="animation-delay:0.6s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="48f739aa-18" type="list" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">费用明细</text></view></view><view class="form-content fee-content"><view class="fee-item"><text class="fee-label">快递费</text><text class="fee-value">{{"¥"+$root.g8}}</text></view><block wx:if="{{totalInsuranceFee>0}}"><view class="fee-item"><text class="fee-label">保价费</text><text class="fee-value">{{"¥"+$root.g9}}</text></view></block><view class="fee-divider"></view><view class="fee-item total"><text class="fee-label">合计</text><text class="fee-value highlight">{{"¥"+$root.g10}}</text></view></view></view></block><block wx:if="{{$root.g11>0}}"><view class="form-card agreement-card" style="animation-delay:0.8s;"><view class="agreement-content"><view data-event-opts="{{[['tap',[['toggleAgreement',['$event']]]]]}}" class="agreement-checkbox" bindtap="__e"><view class="{{['checkbox-wrapper',(formData.agreedToTerms)?'active':'']}}"><uni-icons vue-id="48f739aa-19" type="checkmarkempty" size="16" color="#FFFFFF" vif="formData.agreedToTerms" bind:__l="__l"></uni-icons></view><view class="agreement-text"><text>我已阅读并同意</text><text data-event-opts="{{[['tap',[['handleExpress',['$event']]]]]}}" class="agreement-link" catchtap="__e">《神州邮服务协议》</text></view></view></view><block wx:if="{{showAgreementError}}"><view class="agreement-error"><uni-icons vue-id="48f739aa-20" type="info-filled" size="14" color="#FF5252" bind:__l="__l"></uni-icons><text>请先同意神州邮服务协议</text></view></block></view></block></view></scroll-view></view><block wx:if="{{$root.g12>0}}"><view class="bottom-btn-area"><view class="batch-summary"><text class="batch-count">{{"已填写 "+$root.g13+" 个订单"}}</text><view class="batch-total"><text class="total-label">合计:</text><view class="fee-amount-wrapper"><block wx:if="{{formData.useCommission}}"><text class="deduction-text">{{"已抵扣\n\t\t\t\t\t\t¥"+formData.commissionAmount}}</text></block><text class="fee-amount">{{"¥"+($root.m17-$root.m18>0?$root.g14:'0.00')}}</text></view></view></view><button data-event-opts="{{[['tap',[['showShareGuideLayer',['$event']]]]]}}" class="share-btn wechat" style="margin-right:15px;margin-bottom:1px;" bindtap="__e"><view class="btn-inner"><text>分享获佣金</text></view></button><button data-event-opts="{{[['tap',[['submitOrder',['$event']]]],['touchstart',[['e5',['$event']]]],['touchend',[['e6',['$event']]]],['touchcancel',[['e7',['$event']]]]]}}" class="{{['submit-btn',(submitBtnActive)?'active':'',($root.g15===0)?'disabled':'']}}" bindtap="__e" bindtouchstart="__e" bindtouchend="__e" bindtouchcancel="__e"><text>批量提交</text></button></view></block><block wx:if="{{showShareGuide}}"><view data-event-opts="{{[['tap',[['hideShareGuide',['$event']]]]]}}" class="share-guide-mask" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="guide-content" catchtap="__e"><view class="guide-arrow"></view><view class="guide-box"><view class="guide-text">点击右上角分享按钮分享至朋友圈</view><view class="guide-tips">邀请好友成功注册后可获得佣金奖励</view><button data-event-opts="{{[['tap',[['hideShareGuide',['$event']]]]]}}" class="guide-close-btn" bindtap="__e">我知道了</button></view></view></view></block></view>