<view class="send-container"><view class="tab-header"><block wx:for="{{tabs}}" wx:for-item="tab" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['navToTab',[index]]]]]}}" class="{{['tab-item',[(currentTab===index)?'active':'']]}}" bindtap="__e"><image class="tab-icon" src="{{tab.icon}}" mode="aspectFit"></image><text>{{tab.name}}</text></view></block></view><view class="main-content"><scroll-view class="content-scroll" style="{{'height:'+('calc(100vh - '+(isIPhoneX?'168rpx':'118rpx')+')')+';'}}" scroll-y="{{true}}" scroll-top="{{scrollTop}}"><view class="content-area"><view class="form-card"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-1" type="paperplane" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">寄件人信息</text></view></view><view class="form-content"><block wx:if="{{!formData.senderName}}"><view data-event-opts="{{[['tap',[['selectAddress',['sender']]]]]}}" class="address-empty-card ripple" bindtap="__e"><uni-icons vue-id="6fe5e620-2" type="plusempty" size="24" color="#FF6B01" bind:__l="__l"></uni-icons><text>从地址簿选择寄件人</text></view></block><block wx:else><view class="selected-address-card"><view class="address-info"><view class="address-person-info"><text class="address-name">{{formData.senderName}}</text><text class="address-phone">{{$root.m0}}</text></view><text class="address-detail">{{formData.senderProvince+" "+formData.senderCity+"\n\t\t\t\t\t\t\t\t\t\t"+formData.senderDistrict+" "+formData.senderDetailAddress}}</text></view><view class="address-actions"><view data-event-opts="{{[['tap',[['selectAddress',['sender']]]]]}}" class="address-action-btn ripple" bindtap="__e"><uni-icons vue-id="6fe5e620-3" type="loop" size="16" color="#FF6B01" bind:__l="__l"></uni-icons><text>更换</text></view></view></view></block></view></view><view class="form-card" style="animation-delay:0.1s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-4" type="map-pin-ellipse" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">收件人信息</text></view></view><view class="form-content"><block wx:if="{{!formData.receiverName}}"><view data-event-opts="{{[['tap',[['selectAddress',['receiver']]]]]}}" class="address-empty-card ripple" bindtap="__e"><uni-icons vue-id="6fe5e620-5" type="plusempty" size="24" color="#FF6B01" bind:__l="__l"></uni-icons><text>从地址簿选择收件人</text></view></block><block wx:else><view class="selected-address-card"><view class="address-info"><view class="address-person-info"><text class="address-name">{{formData.receiverName}}</text><text class="address-phone">{{$root.m1}}</text></view><text class="address-detail">{{formData.receiverProvince+"\n\t\t\t\t\t\t\t\t\t\t"+formData.receiverCity+" "+formData.receiverDistrict+"\n\t\t\t\t\t\t\t\t\t\t"+formData.receiverDetailAddress}}</text></view><view class="address-actions"><view data-event-opts="{{[['tap',[['selectAddress',['receiver']]]]]}}" class="address-action-btn ripple" bindtap="__e"><uni-icons vue-id="6fe5e620-6" type="loop" size="16" color="#FF6B01" bind:__l="__l"></uni-icons><text>更换</text></view></view></view></block></view></view><view class="form-card" style="animation-delay:0.2s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-7" type="package" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">物品信息</text></view></view><view class="form-content"><view class="input-row"><view class="legal-notice"><text>请如实填写物品信息，由于虚假信息造成的法律责任，或者快递拦截、退件费用都将由寄件人承担！</text></view><text class="label">物品类型</text><view class="dropdown-wrapper"><view class="input-wrapper"><input class="input" type="text" placeholder="请选择或输入物品类型" data-event-opts="{{[['input',[['__set_model',['','expressTypeQuery','$event',[]]],['onExpressTypeSearch',['$event']]]],['focus',[['e0',['$event']]]],['blur',[['onTypeInputBlur',['$event']]]]]}}" value="{{expressTypeQuery}}" bindinput="__e" bindfocus="__e" bindblur="__e"/><block wx:if="{{expressTypeSearchLoading}}"><view class="search-loading"><view class="loading-dot"></view></view></block><block wx:else><uni-icons class="search-icon" vue-id="6fe5e620-8" type="search" size="16" color="#999" bind:__l="__l"></uni-icons></block></view><block wx:if="{{showTypeDropdown}}"><view class="type-dropdown"><block wx:if="{{$root.g0}}"><view class="type-debug"><text>未找到相关物品类型</text><block wx:if="{{expressTypeQuery}}"><text class="debug-query">{{"搜索词:\n\t\t\t\t\t\t\t\t\t\t\t\t\""+expressTypeQuery+"\""}}</text></block></view></block><block wx:for="{{filteredExpressTypes}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectExpressType',['$0'],[[['filteredExpressTypes','',index]]]]]]]}}" class="type-item ripple" catchtap="__e"><text>{{item.typeName}}</text></view></block></view></block></view></view><view class="input-row"><text class="label">物品重量 (kg)</text><input class="input weight-input" type="digit" placeholder="请输入物品重量" maxlength="5" data-event-opts="{{[['input',[['__set_model',['$0','estimatedItemWeight','$event',[]],['formData']],['validateWeightInput',['$event']]]],['blur',[['checkAndQueryExpress',['$event']]]]]}}" value="{{formData.estimatedItemWeight}}" bindinput="__e" bindblur="__e"/><text class="unit-text">kg</text></view><view class="input-row"><text class="label">物品尺寸 (cm)</text><view class="size-inputs"><input class="input size-input" type="digit" placeholder="长" maxlength="4" data-event-opts="{{[['input',[['__set_model',['$0','length','$event',[]],['formData']],['validateSizeInput',['length','$event']]]]]}}" value="{{$root.g2}}" bindinput="__e"/><text class="size-separator">×</text><input class="input size-input" type="digit" placeholder="宽" maxlength="4" data-event-opts="{{[['input',[['__set_model',['$0','width','$event',[]],['formData']],['validateSizeInput',['width','$event']]]]]}}" value="{{formData.width}}" bindinput="__e"/><text class="size-separator">×</text><input class="input size-input" type="digit" placeholder="高" maxlength="4" data-event-opts="{{[['input',[['__set_model',['$0','height','$event',[]],['formData']],['validateSizeInput',['height','$event']]]]]}}" value="{{formData.height}}" bindinput="__e"/><text class="unit-text">cm</text></view></view><view class="input-row"><text class="label">上门备注</text><input class="input" type="text" placeholder="如特殊要求请备注说明" data-event-opts="{{[['input',[['__set_model',['$0','remark','$event',[]],['formData']]]]]}}" value="{{formData.remark}}" bindinput="__e"/></view></view></view><view class="form-card express-card-section" style="animation-delay:0.3s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-9" type="car" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">快递选项</text></view><block wx:if="{{$root.m2}}"><view data-event-opts="{{[['tap',[['queryExpressOptions',['$event']]]]]}}" class="refresh-btn ripple" bindtap="__e"><uni-icons vue-id="6fe5e620-10" type="refresh" size="16" color="#FF6B01" bind:__l="__l"></uni-icons><text>刷新</text></view></block></view><view class="form-content"><view class="express-options-section"><text class="section-title">快递公司</text><block wx:if="{{expressLoading}}"><view class="express-loading-state"><text>正在获取快递报价...</text><view class="loading-spinner"></view></view></block><block wx:else><block wx:if="{{$root.g3===0}}"><view class="express-empty-hint"><text>请完善寄收件信息获取快递报价</text></view></block><block wx:else><view class="express-list"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="id"><view data-event-opts="{{[['tap',[['selectExpress',[index]]]]]}}" class="{{['express-item-vertical',(formData.expressIndex===index)?'active':'']}}" bindtap="__e"><view class="express-item-left"><image class="express-logo" src="{{item.m3}}" mode="aspectFit"></image><text class="express-name">{{item.$orig.name}}</text></view><view class="express-item-right"><text class="express-price">{{"¥"+item.g4}}</text></view></view></block></view></block></block></view></view></view><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.4s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-11" type="calendar" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">取件时间</text></view></view><view class="form-content"><view class="pickup-time-header"><text class="pickup-tip">快递小哥会在您选择的时间上门取件</text></view><view class="date-selector"><scroll-view class="date-scroll" scroll-x="{{true}}" show-scrollbar="false"><view class="date-scroll-container"><block wx:for="{{pickupDateOptions}}" wx:for-item="date" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectPickupDate',['$0'],[[['pickupDateOptions','',index,'value']]]]]]]}}" class="{{['date-item',(formData.pickupDate===date.value)?'active':'']}}" bindtap="__e"><text class="date-text">{{date.label}}</text></view></block></view></scroll-view></view><view class="time-selector"><view class="time-options"><block wx:for="{{$root.l1}}" wx:for-item="time" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" data-event-params="{{({time})}}" class="{{['time-item',(formData.pickupTime===time.value)?'active':'']}}" bindtap="__e"><text class="time-text">{{time.label}}</text></view></block></view></view></view></view></block><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.5s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-12" type="shield" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">增值服务</text></view></view><view class="form-content"><view class="{{['insurance-card',(!insuranceSupported)?'disabled':'']}}"><view class="insurance-header"><view class="insurance-info"><view class="service-icon"><view class="{{['checkbox-wrapper',(formData.needInsurance&&insuranceSupported)?'active':'']}}"><block wx:if="{{formData.needInsurance&&insuranceSupported}}"><uni-icons vue-id="6fe5e620-13" type="checkmarkempty" size="16" color="#FFFFFF" bind:__l="__l"></uni-icons></block></view></view><view class="service-details"><text class="service-title">保价服务</text><block wx:if="{{insuranceSupported}}"><text class="service-desc">物品损坏或丢失可获得赔偿</text></block><block wx:else><text class="service-desc unavailable">{{insuranceUnavailableReason||'当前快递不支持保价'}}</text></block></view></view><view class="service-toggle"><switch checked="{{formData.needInsurance&&insuranceSupported}}" disabled="{{!insuranceSupported}}" color="#FF6B01" data-event-opts="{{[['change',[['toggleInsurance',['$event']]]]]}}" bindchange="__e"></switch></view></view><block wx:if="{{formData.needInsurance&&insuranceSupported}}"><view class="insurance-amount-section"><view class="insurance-explainer"><uni-icons vue-id="6fe5e620-14" type="info-filled" size="18" color="#FF6B01" bind:__l="__l"></uni-icons><text>保价金额是您物品的实际价值，保价费用根据该金额计算</text></view><block wx:if="{{insuranceRule}}"><view class="insurance-rule"><uni-icons vue-id="6fe5e620-15" type="info" size="16" color="#999999" bind:__l="__l"></uni-icons><text>{{"保价规则: "+insuranceRule}}</text></view></block><view class="amount-section"><view class="amount-label"><text>物品价值</text><text class="hint">(元)</text></view><view class="amount-fee-display"><text class="fee-calc">{{"预计保费: ¥"+$root.g5}}</text></view></view><view class="value-slider-section"><view class="slider-labels"><text>{{minInsuranceAmount+"元"}}</text><text>{{$root.g6+"元"}}</text><text>{{maxInsuranceAmount+"元"}}</text></view><slider min="{{minInsuranceAmount}}" max="{{maxInsuranceAmount}}" step="{{$root.g7}}" value="{{$root.m4}}" activeColor="#FF6B01" backgroundColor="#EEEEEE" blockColor="#FF6B01" blockSize="24" data-event-opts="{{[['change',[['onSliderChange',['$event']]]]]}}" bindchange="__e"></slider></view><view class="value-input-container"><view class="value-input-wrapper"><text class="value-label">物品价值：</text><view class="input-group"><text class="currency-symbol">¥</text><input class="value-input" type="digit" placeholder="输入物品价值" data-event-opts="{{[['input',[['onInsuranceAmountChange',['$event']]]]]}}" value="{{formData.guaranteeValueAmount}}" bindinput="__e"/><text class="unit">元</text></view></view><view class="quick-value-btns"><view data-event-opts="{{[['tap',[['setQuickAmount',[1000]]]]]}}" class="quick-btn" bindtap="__e">1千</view><view data-event-opts="{{[['tap',[['setQuickAmount',[3000]]]]]}}" class="quick-btn" bindtap="__e">3千</view><view data-event-opts="{{[['tap',[['setQuickAmount',[5000]]]]]}}" class="quick-btn" bindtap="__e">5千</view><view data-event-opts="{{[['tap',[['setQuickAmount',[10000]]]]]}}" class="quick-btn" bindtap="__e">1万</view></view></view></view></block></view></view></view></block><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.7s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-16" type="wallet" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">支付方式</text></view></view><view class="form-content"><view class="payment-methods"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='online')?'active':'',(!$root.m5)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon wechat"><uni-icons vue-id="6fe5e620-17" type="weixin" size="20" color="#09BB07" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">微信支付</text><block wx:if="{{$root.m6}}"><text class="payment-desc">支持微信快捷支付</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='online')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='online'}}"><view class="radio-inner"></view></block></view></view></view><block wx:if="{{hasMonthlyAccount}}"><view data-event-opts="{{[['tap',[['e3',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='monthly')?'active':'',(!$root.m7)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon monthly"><uni-icons vue-id="6fe5e620-18" type="calendar" size="20" color="#FF6B01" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">月结账户</text><block wx:if="{{$root.m8}}"><text class="payment-desc">使用企业月结账户支付</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='monthly')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='monthly'}}"><view class="radio-inner"></view></block></view></view></view></block><view data-event-opts="{{[['tap',[['e4',['$event']]]]]}}" class="{{['payment-option',(formData.paymentMethod==='onlineCollect')?'active':'',(!$root.m9)?'disabled':'']}}" bindtap="__e"><view class="payment-left"><view class="payment-icon cod"><uni-icons vue-id="6fe5e620-19" type="shop" size="20" color="#3A86FF" bind:__l="__l"></uni-icons></view><view class="payment-details"><text class="payment-name">线上到付</text><block wx:if="{{$root.m10}}"><text class="payment-desc">快递收货后付款</text></block><block wx:else><text class="payment-desc unavailable">当前快递不支持到付</text></block></view></view><view class="payment-right"><view class="{{['radio-btn',(formData.paymentMethod==='onlineCollect')?'checked':'']}}"><block wx:if="{{formData.paymentMethod==='onlineCollect'}}"><view class="radio-inner"></view></block></view></view></view></view></view></view></block><block wx:if="{{hasExpressOptions&&availableBalance>0}}"><view class="form-card" style="animation-delay:0.6s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-20" type="wallet" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">佣金抵扣</text></view></view><view class="form-content"><view class="{{['balance-card',(!canUseCommission)?'disabled':'']}}"><view class="balance-header"><view class="balance-info"><view class="service-icon"><view class="{{['checkbox-wrapper',(formData.useCommission)?'active':'',(!canUseCommission)?'disabled':'']}}"><block wx:if="{{formData.useCommission}}"><uni-icons vue-id="6fe5e620-21" type="checkmarkempty" size="16" color="#FFFFFF" bind:__l="__l"></uni-icons></block></view></view><view class="service-details"><view><text class="service-title">佣金抵扣</text></view><view><text class="service-desc">{{"可用佣金\n\t\t\t\t\t\t\t\t\t\t\t\t\t¥"+$root.g8}}</text></view></view></view><view class="service-toggle"><switch checked="{{formData.useCommission}}" color="#FF6B01" disabled="{{!canUseCommission}}" data-event-opts="{{[['change',[['toggleUseBalance',['$event']]]]]}}" bindchange="__e"></switch></view></view><block wx:if="{{!canUseCommission}}"><view class="payment-notice"><uni-icons vue-id="6fe5e620-22" type="info" size="14" color="#999" bind:__l="__l"></uni-icons><text>当前快递公司或支付方式不支持使用佣金抵扣</text></view></block><block wx:if="{{formData.useCommission}}"><view class="balance-detail"><view class="balance-explainer"><uni-icons vue-id="6fe5e620-23" type="info-filled" size="18" color="#FF6B01" bind:__l="__l"></uni-icons><text>{{"已抵扣 ¥"+formData.commissionAmount}}</text></view><view class="deduction-info"><text class="deduction-label">抵扣后需支付：</text><text class="deduction-amount">{{"¥"+($root.m11-$root.m12>0?$root.g9:'0.00')}}</text></view></view></block></view></view></view></block><block wx:if="{{hasExpressOptions}}"><view class="form-card" style="animation-delay:0.6s;"><view class="card-header"><view class="title-wrapper"><uni-icons vue-id="6fe5e620-24" type="list" size="20" color="#FF6B01" bind:__l="__l"></uni-icons><text class="card-title">费用明细</text></view></view><view class="form-content fee-content"><view class="fee-item"><text class="fee-label">快递费</text><text class="fee-value">{{"¥"+$root.g10}}</text></view><block wx:if="{{insuranceFee>0}}"><view class="fee-item"><text class="fee-label">保价费</text><text class="fee-value">{{"¥"+$root.g11}}</text></view></block><view class="fee-divider"></view><view class="fee-item total"><text class="fee-label">合计</text><text class="fee-value highlight">{{"¥"+$root.g12}}</text></view></view></view></block><view class="form-card agreement-card" style="animation-delay:0.8s;"><view class="agreement-content"><view data-event-opts="{{[['tap',[['toggleAgreement',['$event']]]]]}}" class="agreement-checkbox" bindtap="__e"><view class="{{['checkbox-wrapper',(formData.agreedToTerms)?'active':'']}}"><block wx:if="{{formData.agreedToTerms}}"><uni-icons vue-id="6fe5e620-25" type="checkmarkempty" size="16" color="#FFFFFF" bind:__l="__l"></uni-icons></block></view><view class="agreement-text"><text>我已阅读并同意</text><text data-event-opts="{{[['tap',[['handleExpress',['$event']]]]]}}" class="agreement-link" catchtap="__e">《神州邮服务协议》</text></view></view></view><block wx:if="{{showAgreementError}}"><view class="agreement-error"><uni-icons vue-id="6fe5e620-26" type="info-filled" size="14" color="#FF5252" bind:__l="__l"></uni-icons><text>请先同意神州邮服务协议</text></view></block></view></view></scroll-view></view><view class="bottom-btn-area"><view class="total-fee"><text class="fee-label">合计</text><view class="fee-amount-wrapper"><block wx:if="{{formData.useCommission}}"><text class="deduction-text">{{"已抵扣\n\t\t\t\t\t\t¥"+formData.commissionAmount}}</text></block><text class="fee-amount">{{"¥"+($root.m13-$root.m14>0?$root.g13:'0.00')}}</text></view></view><button data-event-opts="{{[['tap',[['showShareGuideLayer',['$event']]]]]}}" class="share-btn wechat" bindtap="__e"><view class="btn-inner"><text>分享获佣金</text></view></button><button class="{{['submit-btn',(submitBtnActive)?'active':'']}}" disabled="{{submitting}}" data-event-opts="{{[['tap',[['submitOrder',['$event']]]],['touchstart',[['e5',['$event']]]],['touchcancel',[['e6',['$event']]]]]}}" bindtap="__e" bindtouchstart="__e" bindtouchcancel="__e"><block wx:if="{{!submitting}}"><text>立即下单</text></block><block wx:else><view class="loading-icon"></view></block></button></view><block wx:if="{{showShareGuide}}"><view data-event-opts="{{[['tap',[['hideShareGuide',['$event']]]]]}}" class="share-guide-mask" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="guide-content" catchtap="__e"><view class="guide-arrow"></view><view class="guide-box"><view class="guide-text">点击右上角分享按钮分享至朋友圈</view><view class="guide-tips">邀请好友成功注册后可获得佣金奖励</view><button data-event-opts="{{[['tap',[['hideShareGuide',['$event']]]]]}}" class="guide-close-btn" bindtap="__e">我知道了</button></view></view></view></block></view>